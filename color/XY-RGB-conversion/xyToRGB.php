
<?php
function xyToRgb($x,$y,$bri)
{
    
    $z = 1.0 - $x - $y;
    $Y = $bri;
    $X = ($Y / $y) * $x;
    $Z = ($Y / $y) * $z;

    $r = $X * 1.4628067 - $Y * 0.1840623 - $Z * 0.2743606;
    $g = ($X * -1) *  0.5217933 + $Y * 1.4472381 + $Z *  0.0677227;
    $b = $X *  0.0349342- $Y *0.0968930 + $Z * 1.2884099;

    $r = $r <= 0.0031308 ? 12.92 * $r : (1.0 + 0.055) * pow($r, (1.0 / 2.4)) - 0.055;
    $g = $g <= 0.0031308 ? 12.92 * $g : (1.0 + 0.055) * pow($g, (1.0 / 2.4)) - 0.055;
    $b = $b <= 0.0031308 ? 12.92 * $b : (1.0 + 0.055) * pow($b, (1.0 / 2.4)) - 0.055;


    $r = $r * 255;
    $g = $g * 255;
    $b = $b * 255;
    
    if ($r < 0) $r = 255;
    if ($g < 0) $g = 255;
    if ($b < 0) $b = 255;
    
    $r = round($r);
    $g = round($g);
    $b = round($b);
    
    //unComment for hex
    // $r = dechex(round($r));
    // $g = dechex(round($g));
    // $b = dechex(round($b));

    // if (strlen($r) < 2)     $r = "0" + $r;
    // if (strlen($g) < 2)     $g = "0" + $g;
    // if (strlen($b) < 2)     $b = "0" + $b;

    return [$r,$g,$b];
}
?>
